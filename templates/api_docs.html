<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .endpoint { background: #f5f5f5; padding: 15px; margin: 10px 0; border-left: 4px solid #007bff; }
        .method { display: inline-block; padding: 5px 10px; border-radius: 3px; color: white; font-weight: bold; }
        .get { background: #28a745; }
        .post { background: #007bff; }
        .put { background: #ffc107; color: #212529; }
        .delete { background: #dc3545; }
        code { background: #e9ecef; padding: 2px 5px; border-radius: 3px; }
        pre { background: #f8f9fa; padding: 15px; border-radius: 5px; overflow: auto; }
        .tester { border: 1px solid #ddd; padding: 20px; margin-top: 30px; border-radius: 5px; }
        .tester input, .tester select, .tester button { margin: 5px; padding: 8px; }
        .response { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API</h1>
    <nav>
        <a href="/">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a> |
        {% if user_name %}
            <span>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <strong>{{ user_name }}</strong></span> |
            <a href="/logout">–í—ã–π—Ç–∏</a>
        {% else %}
            <a href="/login/">–í—Ö–æ–¥</a> |
            <a href="/register/">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        {% endif %}
    </nav>
    <hr>
    <h2>–ë–∞–∑–æ–≤—ã–π URL</h2>
    <p><code>http://–≤–∞—à-–¥–æ–º–µ–Ω/api/v1/</code></p>
    <h2>–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
    <p>–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω.</p>
    <pre>Authorization: Bearer –≤–∞—à_—Ç–æ–∫–µ–Ω</pre>
    <h2>–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã</h2>
    <div class="endpoint">
        <h3><span class="method get">GET</span> –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤</h3>
        <p><code>/api/v1/posts</code></p>
        <p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (query):</strong></p>
        <ul>
            <li><code>page</code> (int) ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á. 1)</li>
            <li><code>per_page</code> (int) ‚Äî –ø–æ—Å—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á. 10)</li>
            <li><code>category_id</code> (int) ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</li>
            <li><code>sort_by</code> (string) ‚Äî –ø–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏: <code>created_at</code>, <code>title</code></li>
            <li><code>order</code> (string) ‚Äî –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: <code>asc</code>, <code>desc</code></li>
            <li><code>q</code> (string) ‚Äî –ø–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é</li>
        </ul>
        <p>–ü—Ä–∏–º–µ—Ä: <code>/api/v1/posts?category_id=1&sort_by=title&order=asc&q=python</code></p>
    </div>
    <div class="endpoint">
        <h3><span class="method get">GET</span> –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞</h3>
        <p><code>/api/v1/posts/{id}</code></p>
    </div>
    <div class="endpoint">
        <h3><span class="method post">POST</span> –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
        <p><code>/api/v1/login</code></p>
        <p>–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):</p>
        <pre>{
    "email": "user@example.com",
    "password": "password123"
}</pre>
    </div>
    <div class="endpoint">
        <h3><span class="method post">POST</span> –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ (—Ç–æ–∫–µ–Ω)</h3>
        <p><code>/api/v1/posts</code></p>
        <p>–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):</p>
        <pre>{
    "title": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
    "content": "–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ...",
    "category_id": 1
}</pre>
    </div>
    <div class="endpoint">
        <h3><span class="method put">PUT</span> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ (—Ç–æ–∫–µ–Ω)</h3>
        <p><code>/api/v1/posts/{id}</code></p>
        <p>–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):</p>
        <pre>{
    "title": "–ù–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫",
    "content": "–ù–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ...",
    "category_id": 2
}</pre>
    </div>
    <div class="endpoint">
        <h3><span class="method delete">DELETE</span> –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ (–∞–¥–º–∏–Ω-—Ç–æ–∫–µ–Ω)</h3>
        <p><code>/api/v1/posts/{id}</code></p>
    </div>
    <div class="endpoint">
        <h3><span class="method get">GET</span> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
        <p><code>/api/v1/categories</code></p>
    </div>
    <hr>
    <div class="tester">
        <h2>üõ† –¢–µ—Å—Ç–µ—Ä API</h2>
        <p>–û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä—è–º–æ –æ—Ç—Å—é–¥–∞:</p>
        <div>
            <select id="method">
                <option value="GET">GET</option>
                <option value="POST">POST</option>
                <option value="PUT">PUT</option>
                <option value="DELETE">DELETE</option>
            </select>
            <input type="text" id="url" placeholder="/api/v1/posts" size="50" value="/api/v1/posts">
            <br><br>
            <label>–¢–æ–∫–µ–Ω (Bearer):</label>
            <input type="text" id="token" placeholder="–≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω" size="40">
            <br><br>
            <div id="body-container" style="display: none;">
                <label>–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON):</label><br>
                <textarea id="body" rows="6" cols="60"></textarea>
            </div>
            <button onclick="sendRequest()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
            <button onclick="clearResponse()">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        <div class="response" id="response">
            <pre>–û—Ç–≤–µ—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...</pre>
        </div>
    </div>
    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å/—Å–∫—Ä—ã–≤–∞—Ç—å –ø–æ–ª–µ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Ç–æ–¥–∞
        document.getElementById('method').addEventListener('change', function() {
            const method = this.value;
            const bodyContainer = document.getElementById('body-container');
            if (method === 'POST' || method === 'PUT') {
                bodyContainer.style.display = 'block';
            } else {
                bodyContainer.style.display = 'none';
            }
        });
        async function sendRequest() {
            const method = document.getElementById('method').value;
            let url = document.getElementById('url').value;
            const token = document.getElementById('token').value;
            const bodyText = document.getElementById('body').value;
            const headers = {
                'Content-Type': 'application/json'
            };
            
            if (token) {
                headers['Authorization'] = 'Bearer ' + token;
            }
            const options = {
                method: method,
                headers: headers
            };
            if (method === 'POST' || method === 'PUT') {
                options.body = bodyText;
            }
            try {
                const response = await fetch(url, options);
                const data = await response.json();
                document.getElementById('response').innerHTML = 
                    '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (error) {
                document.getElementById('response').innerHTML = 
                    '<pre style="color: red;">–û—à–∏–±–∫–∞: ' + error + '</pre>';
            }
        }
        function clearResponse() {
            document.getElementById('response').innerHTML = '<pre>–û—Ç–≤–µ—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...</pre>';
        }
    </script>
</body>
</html>